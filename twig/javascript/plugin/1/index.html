<style>
    textarea { padding: 5px; border: solid 1px #ccc; background: #f7f7f7; border-color: #ddd #aaa #aaa #ddd; width: 922px; line-height: 20px; height: 100px; }
    #btnCopy, #btnClear { margin: 20px 20px 0; padding: 9px 20px; background: #27931b; border: solid 1px #238a18; border-color: #238a18 #1e7f13 #1e7f13 #238a18; color: #fff; font: bold 14px/18px Verdana, Geneva, sans-serif; cursor: pointer; }
</style>
<script src="{{pack}}ZeroClipboard.js"></script>
<h1>HTML转义</h1>
<div class="column">
    <h2>效果展示</h2>
    <div class="column_c mt3" onLoad="initCopyResult()">
        <p>转义前</p>
        <textarea id="original" onkeyup="htmlEscape()"></textarea>
        <p>转义后</p>
        <textarea id="result"></textarea>
        <p class="tac">
            <input id="btnCopy" type="button" value="复 制">
            <input id="btnClear" type="button" value="清 空" onClick="clearData()">
        </p>

        <script>
            var original = document.getElementById("original");
            var result = document.getElementById("result");
            //转义
            function htmlEscape() {
                var originalTxt = original.value;
                var resultTxt = String(originalTxt)
                    .replace(/&/g, '&amp;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#39;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/\\/g, '&#92;');
                result.value = resultTxt;
            }
            //复制转义结果
            function initCopyResult() {
                var clip = new ZeroClipboard(document.getElementById("btnCopy"));
                clip.setText(result.value);
                clip.setHandCursor(true);
                clip.addEventListener('mouseup', function (client) {
                    clip.setText( result.value );
                });

                clip.addEventListener('complete', function (client, text) {
                    alert("该地址已经复制，你可以使用Ctrl+V 粘贴。");
                });
            }
            //清空textarea，转义前textarea获取焦点
            function clearData() {
                original.value = "";
                result.value = "";
                original.focus();
            }
        </script>
    </div>
</div>
<div class="column mt4">
    <h2>代码展示</h2>
    <div class="column_c">
        <h3>HTML</h3>
        <pre>&lt;p&gt;转义前&lt;/p&gt;
&lt;textarea id=&quot;original&quot; onkeyup=&quot;htmlEscape()&quot;&gt;&lt;/textarea&gt;
&lt;p&gt;转义后&lt;/p&gt;
&lt;textarea id=&quot;result&quot;&gt;&lt;/textarea&gt;
&lt;p class=&quot;tac&quot;&gt;
&lt;input id=&quot;btnCopy&quot; type=&quot;button&quot; value=&quot;复制&quot; onClick=&quot;copyResult()&quot;&gt;
&lt;input id=&quot;btnClear&quot; type=&quot;button&quot; value=&quot;清空&quot; onClick=&quot;clearData()&quot;&gt;
&lt;/p&gt;</pre>
        <h3>JS</h3>
        <pre>&lt;script src=&quot;ZeroClipboard.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
var original = document.getElementById(&quot;original&quot;);
var result = document.getElementById(&quot;result&quot;);
//转义
function htmlEscape() {
var originalTxt = original.value;
var resultTxt = String(originalTxt)
    .replace(/&amp;/g, &#39;&amp;amp;&#39;)
    .replace(/&quot;/g, &#39;&amp;quot;&#39;)
    .replace(/&#39;/g, &#39;&amp;#39;&#39;)
    .replace(/&lt;/g, &#39;&amp;lt;&#39;)
    .replace(/&gt;/g, &#39;&amp;gt;&#39;)
    .replace(/&#92;&#92;/g, &#39;&amp;#92;&#39;);
result.value = resultTxt;
}
//复制转义结果
function initCopyResult() {
var clip = new ZeroClipboard(document.getElementById(&quot;btnCopy&quot;));
clip.setText(result.value);
clip.setHandCursor(true);
clip.addEventListener(&#39;mouseup&#39;, function (client) {
    clip.setText( result.value );
});

clip.addEventListener(&#39;complete&#39;, function (client, text) {
    alert(&quot;该地址已经复制，你可以使用Ctrl+V 粘贴。&quot;);
});
}
//清空textarea，转义前textarea获取焦点
function clearData() {
original.value = &quot;&quot;;
result.value = &quot;&quot;;
original.focus();
}
&lt;/script&gt;</pre>
    </div>
</div>
<div class="column mt4">
    <h2>相关文件下载</h2>
    <ul class="download">
        <li>ZeroClipboard插件<a href="ZeroClipboard.js" target="_blank">ZeroClipboard.js</a></li>
        <li>ZeroClipboard插件<a href="ZeroClipboard.swf" target="_blank">ZeroClipboard.swf</a></li>
        <li>完整ZeroClipboard插件压缩包<a href="ZeroClipboard-master.zip" target="_blank">ZeroClipboard-master.zip</a></li>
    </ul>
</div>
<div class="column mt4">
    <h2>要点总结</h2>
    <ul class="summary">
        <li><span class="fc4">replace()</span> 的用法。</li>
        <li>js复制到剪贴板功能，IE下可以使用 <span class="fc4">window.clipboardData.setData</span> 实现，其它各浏览器不兼容，需要借助 <span class="fc4">ZeroClipboard</span> 插件，利用flash来实现复制到剪贴板功能，上面提供了必需的 <span class="fc4">ZeroClipboard.js</span> 和 <span class="fc4">ZeroClipboard.swf</span>，使用的时候只要引入 ZeroClipboard.js 就可以了。具体使用方法请参考：<a href="https://github.com/jonrohan/ZeroClipboard" target="_blank" class="fc2">https://github.com/jonrohan/ZeroClipboard</a>。</li>
        <li>ZeroClipboard插件本地不起作用，必须上传到服务器才能使用。</li>
    </ul>
</div>