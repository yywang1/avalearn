<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>输入框特效</title>
<link rel="shortcut icon" href="http://avaforvr.one.zcyj.info/favicon.ico">
<link type="text/css" rel="stylesheet" href="../../../global.css" />
<style>
input[type="text"] { margin-right: 20px; border: solid 1px #ccc; padding: 5px 10px; height:26px; background:#fff; font-size:16px; }
</style>
<script type="text/javascript" src="../../../jquery-1.6.1.min.js"></script>
</head>

<body id="modules">
<div class="wrapper">
    <iframe width="960" align="center" height="125" frameborder="0" scrolling="no" src="../../../header2.html"></iframe>
    <div class="main">
        <h1>输入框特效</h1>
        <div class="column">
            <h2>效果展示</h2>
            <div class="column_c mt3">
                <dl>
                	<dt class="fs2">模拟输入框 placeholder 属性</dt>
                    <dd class="mt1">
                        <input type="text" dvalue="请输入xxxx" value="请输入xxxx">
                        <script>
                        $('input[type="text"]').focus(function () {
                            if ($(this).attr('dValue') && $(this).attr('dValue') != '') {
                                if ($(this).val() == $(this).attr('dValue')) {
                                    $(this).val('')
                                }
                            }
                        }).blur(function () {
                            if ($(this).attr('dValue') && $(this).attr('dValue') != '') {
                                if ($(this).val() == '') {
                                    $(this).val($(this).attr('dValue'))
                                }
                            }
                        })
                        </script>
                    </dd>
                	<dt class="fs2 mt4">输入框联想功能</dt>
                    <dd class="mt1">
                    	<input type="text" id="loginEmail">
                        <script>
						var _gaq = [], litb = {
							"baseURL" : "https:\/\/www.lightinthebox.com\/",
							"resouceURL" : "https:\/\/www.lightinthebox.com\/resource_34bdc6c4b3eb489047c809e542844eb02cd89e85\/dev_v2\/",
							"siteWater" : "",
							"imageURL" : "https:\/\/www.lightinthebox.com\/",
							"imagesURL" : ["http:\/\/cloud1.lbox.me\/", "http:\/\/cloud2.lbox.me\/", "http:\/\/cloud3.lbox.me\/", "http:\/\/cloud4.lbox.me\/", "http:\/\/cloud5.lbox.me\/", "http:\/\/cloud6.lbox.me\/", "http:\/\/cloud7.lbox.me\/", "http:\/\/cloud8.lbox.me\/"],
							"theme" : "default",
							"curDate" : "2013/08/24 00:18:53",
							"lan" : "en",
							"currency" : "USD",
							"ctrPath" : "https:\/\/ctrlitb.lbox.me\/ctr_tracking.php",
							"currSymbol" : "USD $",
							"decimal_places" : "2",
							"mainPage" : "login",
							"ctr" : {
								"country" : "US",
								"currency" : "USD"
							},
							"abTestType" : "ATest",
							"pageTemplate" : "",
							"cutSel" : "US",
							"pid" : -1,
							"cid" : -1
						};
						litb.startTime = (new Date()).getTime();
						new Image().src = litb.resouceURL + 'langs/' + litb.lan + '/newblue_buttons.png';
						
						
                        $.fn.autocompleteEmail = function (options) {
                            var me = this,
                            $input = $(this);
                            var defaults = {
                                resultsClass : "mailInstant",
                                resultsid : "resultsEmail",
                                overClass : "over",
                                minChars : 1,
                                zIndex : 9992,
                                width : 2,
                                delay : 50,
                                esc : false,
                                data : []
                            };
                            var options = $.extend(defaults, options);
                            var timeout = null;
                            var active = -1;
                            var hasFocus = false;
                            var prev = "";
                            litb.emailList = '';
                            var lastKeyPressCode = null;
                            var _url = litb.baseURL + 'index.php?main_page=info_check&action=get_email_domains&language=' + litb['lan'];
                            this.init = function () {
                                var results = document.createElement("div");
                                var $results = $(results);
                                $results.css("z-index", options.zIndex);
                                $results.attr("id", options.resultsid);
                                $results.hide().addClass(options.resultsClass).css("position", "absolute");
                                if (!$('#' + options.resultsid)[0])
                                    $("body").prepend(results)
                            };
                            $(document).ready(function () {
                                if (litb.emailList == '') {
                                    $.ajax({
                                        type : 'post',
                                        url : _url,
                                        success : function (data) {
                                            data = eval('[' + data + ']')[0];
                                            if (data != '') {
                                                litb.emailList = data
                                            }
                                        }
                                    })
                                }
                            });
                            function hidePP(e) {
                                var unicode = e.keyCode ? e.keyCode : e.charCode;
                                if (unicode == 27) {
                                    $('#' + options.resultsid).hide();
                                    options.esc = true;
                                    $(document).unbind('keydown', hidePP)
                                }
                            };
                            $(document).keydown(hidePP);
                            this.showResult = function () {
                                if (!$input.val())
                                    return;
                                me.requestData()
                            };
                            this.showHtml = function (data, _len, _val, __val, ul) {
                                for (var i = 0; i < data.length; i++) {
                                    var li = document.createElement("li");
                                    li.innerHTML = '<span>' + __val + '</span>@' + data[i];
                                    ul.appendChild(li);
                                    if (_len != -1 && data[i].indexOf(_val) != 0) {
                                        $(li).remove()
                                    } else {
                                        $(li).show()
                                    }
                                }
                                $('h4', ul).after('<li>' + $input.val() + '</li>');
                                $('li', ul).each(function (n) {
                                    if (n > 11) {
                                        $(this).remove()
                                    } else if (n > 0 && $(this).text() == $input.val()) {
                                        $(this).remove()
                                    } else {
                                        $(this).hover(function () {
                                            $(this).addClass(options.overClass);
                                            active = n
                                        }, function () {
                                            $(this).removeClass(options.overClass)
                                        }).click(function (e) {
                                            me.selectItem(this);
                                            e.preventDefault();
                                            e.stopPropagation()
                                        })
                                    }
                                    $(this).attr({
                                        title : $(this).text(),
                                        alt : $(this).text()
                                    })
                                });
                                $("#" + options.resultsid).css({
                                    top : ($input.offset().top + $input.outerHeight() - 1) + "px",
                                    left : $input.offset().left + "px",
                                    width : $input.width() + options.width
                                }).html(ul).show()
                            };
                            this.requestData = function () {
                                var ul = document.createElement("ul");
                                var _title = document.createElement("h4");
                                $(_title).html(litb.langs.selecteMailType);
                                ul.appendChild(_title);
                                var _val = $input.val(),
                                __val = $input.val();
                                var _len = _val.indexOf('@');
                                if (_len != -1) {
                                    _val = _val.substring(_len + 1, _val.length);
                                    __val = $input.val().substring(0, _len)
                                }
                                if (litb.emailList == '') {
                                    $.ajax({
                                        type : 'post',
                                        url : _url,
                                        data : '',
                                        complete : function () {},
                                        success : function (data) {
                                            data = eval('[' + data + ']')[0];
                                            if (data != '') {
                                                me.showHtml(data, _len, _val, __val, ul);
                                                litb.emailList = data
                                            }
                                        },
                                        error : function () {}
                        
                                    })
                                } else {
                                    me.showHtml(litb.emailList, _len, _val, __val, ul)
                                }
                            };
                            this.selectItem = function (li) {
                                var v = $.trim($(li).text());
                                $input.val(v);
                                me.hideResultsNow()
                            };
                            this.hideResultsNow = function () {
                                if (timeout)
                                    clearTimeout(timeout);
                                timeout = setTimeout(function () {
                                        if ($("#" + options.resultsid).is(":visible")) {
                                            $("#" + options.resultsid).hide()
                                        }
                                    }, 200)
                            };
                            this.onChange = function () {
                                if ((lastKeyPressCode >= 33 && lastKeyPressCode <= 45) || lastKeyPressCode == 144 || lastKeyPressCode == 145 || lastKeyPressCode == 9 || (lastKeyPressCode >= 112 && lastKeyPressCode <= 135))
                                    return;
                                var v = $input.val();
                                if (v.length >= options.minChars && !options.esc) {
                                    me.showResult()
                                } else {
                                    $("#" + options.resultsid).hide()
                                };
                                options.esc = false
                            };
                            this.moveSelect = function (step) {
                                var lis = $("li", $("#" + options.resultsid));
                                active += step;
                                if (active < 0) {
                                    active = lis.size() - 1
                                } else if (active >= lis.size()) {
                                    active = 0
                                };
                                $(lis).removeClass(options.overClass);
                                $(lis).eq(active).addClass(options.overClass);
                                $input.val($(lis).eq(active).text())
                            };
                            $input.keyup(function (e) {
                                if (lastKeyPressCode == 13)
                                    return;
                                hasFocus = true;
                                lastKeyPressCode = e.keyCode;
                                if (lastKeyPressCode < 37 || lastKeyPressCode > 40) {
                                    active = -1;
                                    if (timeout)
                                        clearTimeout(timeout);
                                    timeout = setTimeout(function () {
                                            me.onChange()
                                        }, options.delay)
                                }
                            }).keydown(function (e) {
                                hasFocus = true;
                                lastKeyPressCode = e.keyCode;
                                switch (e.keyCode) {
                                case 13:
                                    if ($input.val() == "") {};
                                    me.hideResultsNow();
                                    if ($('#resultsEmail')[0].style.display == "block") {
                                        e.keyCode = 0;
                                        return false
                                    }
                                    break;
                                case 38:
                                    e.preventDefault();
                                    if ($("#" + options.resultsid).is(":visible"))
                                        me.moveSelect(-1);
                                    break;
                                case 40:
                                    e.preventDefault();
                                    if ($("#" + options.resultsid).is(":visible"))
                                        me.moveSelect(1);
                                    break;
                                default:
                                    break
                                }
                            }).blur(function () {
                                hasFocus = false;
                                me.hideResultsNow()
                            });
                            this.init()
                        };
						$('#loginEmail').autocompleteEmail();
                        </script>
                    </dd>
                </dl>
            </div>
        </div>            
        <div class="column mt4">
            <h2>代码展示</h2>
            <div class="column_c">
            	<h3>HTML</h3>
                <pre>&lt;div class=&quot;sele&quot; style=&quot;width:150px&quot;&gt;
    &lt;input type=&quot;text&quot; value=&quot;全部地区&quot; /&gt;
    &lt;ul&gt;
        &lt;li&gt;全部地区&lt;/li&gt;
        &lt;li&gt;上城区&lt;/li&gt;
        &lt;li&gt;下城区&lt;/li&gt;
        &lt;li&gt;江干区&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;</pre>
            	<h3>CSS</h3>
                <pre>.sele { height: 42px; position: relative; margin-bottom: 10px; }
.sele input { position: absolute; left: 0; top: 0; height: 38px; line-height: 38px !important; overflow: hidden; cursor: pointer; padding: 0 36px 0 15px; background: url(chSelect.gif) no-repeat 100% 0 #fff; border: solid 2px #dbdbdb; color: #131313; font-size: 18px; font-family: &quot;Microsoft YaHei&quot;; }
.sele .open { border: solid 2px #97c4ee; }
.sele ul { width: 100%; position: absolute; top: 40px; left: 0; background: #fff; border-top: solid 2px #97c4ee; overflow-x: hidden; overflow-y: auto; display: none; }
.sele li { cursor: pointer; height: 30px; line-height: 30px; white-space: nowrap; border: solid 2px #97c4ee; border-top: none; background: #fff; color: #333; font-size: 14px; padding: 0 15px; }
.sele li:hover { background: #f1f1f1; }</pre>
            	<h3>JS</h3>
                <pre>&lt;script type=&quot;text/javascript&quot; src=&quot;../../../jquery-1.6.1.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;funcSelect.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
$(document).ready(function(){
	$(&quot;.sele&quot;).each(function(){
		$(this).funcSelect({maxNum:8,liH:32,plusW:55});
	});
});
&lt;/script&gt;</pre>
            </div>
        </div>
        <div class="column mt4">
            <h2>相关文件下载</h2>
            <ul class="download">
            	<li>jquery基本包<a href="../../../jquery-1.6.1.min.js" target="_blank">jquery-1.6.1.min.js</a></li>
                <li>仿select的封装js<a href="funcSelect.js" target="_blank">funcSelect.js</a></li>
            </ul>
        </div>
        <div class="column mt4">
            <h2>要点总结</h2>
            <ul class="summary">
            	<li>三个参数：下拉选项中li的高度，不出现滚动的情况下可以显示的li的最大个数，最外层div与输入框宽度的差值；</li>
            	<li>js中加入了判断语句，若输入框处被替换成a或span等标签，则不执行点击下拉选项赋值的操作；</li>
            	<li>使用 <span class="fc4">get(0)</span> 可以选择一个实际的DOM元素并且对他直接操作，$(this).get(0)与$(this)[0]等价。</li>
            </ul>
        </div>
    </div>
    <iframe width="960" align="center" height="47" frameborder="0" scrolling="no" src="../../../footer.html"></iframe>
</div>
</body>
</html>
